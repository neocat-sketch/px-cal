<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PX ì •ì‚°ê¸° Pro (Storage)</title>
    <style>
        :root { --primary: #1b5e20; --secondary: #4caf50; --bg: #f0f2f5; }
        body { font-family: -apple-system, sans-serif; background-color: var(--bg); margin: 0; padding: 0; }
        .tab-menu { display: flex; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 10; }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; font-size: 1rem; font-weight: bold; color: #777; cursor: pointer; border-bottom: 3px solid transparent; }
        .tab-btn.active { color: var(--primary); border-bottom: 3px solid var(--primary); }
        .content { padding: 20px; display: none; }
        .content.active { display: block; }
        .card { background: white; border-radius: 12px; padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h3 { margin-top: 0; font-size: 1.1rem; color: #333; margin-bottom: 15px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.85rem; color: #666; margin-bottom: 6px; }
        .input-wrapper { position: relative; display: flex; align-items: center; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1.1rem; box-sizing: border-box; background: #fafafa; }
        input:focus { border-color: var(--secondary); outline: none; background: white; }
        .unit { position: absolute; right: 12px; color: #999; font-weight: bold; }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-save { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; margin-top: 10px; cursor: pointer; }
        .btn-save:active { background: var(--secondary); }
        .btn-reset { width: 100%; padding: 10px; background: #eee; border: none; border-radius: 8px; font-size: 0.8rem; color: #666; margin-top: 15px; }

        .res-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #eee; font-size: 0.95rem; }
        .res-row:last-child { border-bottom: none; }
        .res-label { color: #555; }
        .res-val { font-weight: 600; color: #222; }
        .minus { color: #d32f2f; }
        .highlight { color: var(--primary); font-weight: 800; font-size: 1.3rem; }
        .info-text { font-size: 0.8rem; color: #999; text-align: center; margin-top: 10px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="tab-menu">
    <button class="tab-btn active" onclick="openTab(event, 'calc-tab')">ê¸ˆì•¡ ê³„ì‚°</button>
    <button class="tab-btn" onclick="openTab(event, 'config-tab')">í™˜ê²½ ì„¤ì •</button>
</div>

<div id="calc-tab" class="content active">
    <div class="card">
        <h3>ğŸ’° ê¸ˆì•¡ ì…ë ¥</h3>
        <div class="input-group">
            <label>PX íŒë§¤ê°€ (VAT ë³„ë„)</label>
            <div class="input-wrapper">
                <input type="number" id="inputSalePrice" placeholder="ê¸ˆì•¡ ì…ë ¥" oninput="calculateAll()">
                <span class="unit">ì›</span>
            </div>
        </div>
    </div>

    <div class="card" id="resultCard">
        <h3>ğŸ“Š ê³„ì‚° ìƒì„¸</h3>
        <div class="res-row"><span class="res-label">0. PX íŒë§¤ê°€</span><span class="res-val" id="row0">0 ì›</span></div>
        <div class="res-row"><span class="res-label">1. ë³µì§€ìœ¨ ì°¨ê°</span><span class="res-val minus" id="row1">0 ì›</span></div>
        <div class="res-row" style="background: #f9f9f9; padding: 12px 5px; border-radius: 5px;"><span class="res-label" style="font-weight:bold;">2. PX ë‚©í’ˆê°€</span><span class="res-val" id="row2" style="color:#1976d2;">0 ì›</span></div>
        <div class="res-row"><span class="res-label">3. ê´€ë¦¬ìˆ˜ìˆ˜ë£Œ (ë‚©í’ˆê°€ ê¸°ì¤€)</span><span class="res-val minus" id="row3">0 ì›</span></div>
        <div class="res-row"><span class="res-label">4. ì¹´ë“œìˆ˜ìˆ˜ë£Œ (íŒë§¤ê°€ ê¸°ì¤€)</span><span class="res-val minus" id="row4">0 ì›</span></div>
        <div class="res-row"><span class="res-label">5. ë¬¼ë¥˜ìœ„íƒìˆ˜ìˆ˜ë£Œ (ë‚©í’ˆê°€ ê¸°ì¤€)</span><span class="res-val minus" id="row5">0 ì›</span></div>
        <div class="res-row" style="margin-top:10px; border-top: 2px solid #333; padding-top: 15px;">
            <span class="res-label" style="font-weight:bold;">6. ìµœì¢… ì •ì‚°ê¸ˆì•¡</span>
            <span class="res-val highlight" id="row6">0 ì›</span>
        </div>
    </div>
</div>

<div id="config-tab" class="content">
    <div class="card">
        <h3>âš™ï¸ ìˆ˜ìˆ˜ë£Œ ì„¤ì • ì €ì¥</h3>
        <div class="input-group">
            <label>ë³µì§€ìœ¨ (íŒë§¤ê°€ ê¸°ì¤€, %)</label>
            <div class="input-wrapper">
                <input type="number" id="cfgWelfare" step="0.01">
                <span class="unit">%</span>
            </div>
        </div>
        <div class="input-group">
            <label>ê´€ë¦¬ìˆ˜ìˆ˜ë£Œ (ë‚©í’ˆê°€ ê¸°ì¤€, %)</label>
            <div class="input-wrapper">
                <input type="number" id="cfgAdmin" step="0.01">
                <span class="unit">%</span>
            </div>
        </div>
        <div class="input-group">
            <label>ì¹´ë“œìˆ˜ìˆ˜ë£Œ (íŒë§¤ê°€ ê¸°ì¤€, %)</label>
            <div class="input-wrapper">
                <input type="number" id="cfgCard" step="0.1">
                <span class="unit">%</span>
            </div>
        </div>
        <div class="input-group">
            <label>ë¬¼ë¥˜ìœ„íƒìˆ˜ìˆ˜ë£Œ (ë‚©í’ˆê°€ ê¸°ì¤€, %)</label>
            <div class="input-wrapper">
                <input type="number" id="cfgShip" step="0.1">
                <span class="unit">%</span>
            </div>
        </div>
        
        <button class="btn-save" onclick="saveSettings()">í™˜ê²½ì„¤ì • ì €ì¥í•˜ê¸°</button>
        <button class="btn-reset" onclick="resetDefaults()">ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”</button>
    </div>
    <p class="info-text">ì €ì¥í•˜ê¸°ë¥¼ ëˆ„ë¥´ë©´ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ë„<br>ì„¤ì •ê°’ì´ ìœ ì§€ë©ë‹ˆë‹¤.</p>
</div>

<script>
    const defaults = { welfare: 7.2, admin: 4.09, card: 2.5, ship: 11 };

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì™€ì„œ í•„ë“œì— ì±„ì›€
    window.onload = function() {
        document.getElementById('cfgWelfare').value = localStorage.getItem('px_welfare') || defaults.welfare;
        document.getElementById('cfgAdmin').value = localStorage.getItem('px_admin') || defaults.admin;
        document.getElementById('cfgCard').value = localStorage.getItem('px_card') || defaults.card;
        document.getElementById('cfgShip').value = localStorage.getItem('px_ship') || defaults.ship;
        calculateAll();
    };

    // [ì €ì¥í•˜ê¸°] ë²„íŠ¼ ë¡œì§
    function saveSettings() {
        const w = document.getElementById('cfgWelfare').value;
        const a = document.getElementById('cfgAdmin').value;
        const c = document.getElementById('cfgCard').value;
        const s = document.getElementById('cfgShip').value;

        localStorage.setItem('px_welfare', w);
        localStorage.setItem('px_admin', a);
        localStorage.setItem('px_card', c);
        localStorage.setItem('px_ship', s);

        alert("ì„¤ì •ê°’ì´ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        calculateAll(); // ì €ì¥ í›„ ì¦‰ì‹œ ê³„ì‚° ë¡œì§ ë°˜ì˜
        openTab(null, 'calc-tab'); // ì €ì¥ í›„ ê³„ì‚° íƒ­ìœ¼ë¡œ ì´ë™ (ì‚¬ìš©ì í¸ì˜)
    }

    function resetDefaults() {
        if(confirm("ëª¨ë“  ìˆ˜ìˆ˜ë£Œë¥¼ ì´ˆê¸° ë””í´íŠ¸ê°’ìœ¼ë¡œ ë˜ëŒë¦´ê¹Œìš”?")) {
            document.getElementById('cfgWelfare').value = defaults.welfare;
            document.getElementById('cfgAdmin').value = defaults.admin;
            document.getElementById('cfgCard').value = defaults.card;
            document.getElementById('cfgShip').value = defaults.ship;
            saveSettings();
        }
    }

    function calculateAll() {
        const salePrice = parseFloat(document.getElementById('inputSalePrice').value) || 0;
        const rateWelfare = (parseFloat(document.getElementById('cfgWelfare').value) || 0) / 100;
        const rateAdmin = (parseFloat(document.getElementById('cfgAdmin').value) || 0) / 100;
        const rateCard = (parseFloat(document.getElementById('cfgCard').value) || 0) / 100;
        const rateShip = (parseFloat(document.getElementById('cfgShip').value) || 0) / 100;

        const welfareAmt = salePrice * rateWelfare;           
        const supplyPrice = salePrice - welfareAmt;           
        const adminFee = supplyPrice * rateAdmin;             
        const cardFee = salePrice * rateCard;                 
        const shipFee = supplyPrice * rateShip;               
        const finalAmt = supplyPrice - (adminFee + cardFee + shipFee); 

        const f = (n) => Math.round(n).toLocaleString() + " ì›";
        document.getElementById('row0').innerText = f(salePrice);
        document.getElementById('row1').innerText = "-" + f(welfareAmt);
        document.getElementById('row2').innerText = f(supplyPrice);
        document.getElementById('row3').innerText = "-" + f(adminFee);
        document.getElementById('row4').innerText = "-" + f(cardFee);
        document.getElementById('row5').innerText = "-" + f(shipFee);
        document.getElementById('row6').innerText = f(finalAmt);
    }

    function openTab(evt, tabName) {
        var i, content, tabBtn;
        content = document.getElementsByClassName("content");
        for (i = 0; i < content.length; i++) { content[i].style.display = "none"; }
        tabBtn = document.getElementsByClassName("tab-btn");
        for (i = 0; i < tabBtn.length; i++) { tabBtn[i].className = tabBtn[i].className.replace(" active", ""); }
        document.getElementById(tabName).style.display = "block";
        if(evt) {
            evt.currentTarget.className += " active";
        } else {
            document.querySelector(`button[onclick*='${tabName}']`).className += " active";
        }
    }
</script>

</body>
</html>
